---
import Layout from '../../layouts/Layout.astro';
import { listPhotos, getPhotoBySlug } from '../../lib/data';

export async function getStaticPaths() {
  const photos = await listPhotos();
  return photos.map(p => ({ params: { slug: p.slug } }));
}

const { slug } = Astro.params;
const photo = await getPhotoBySlug(slug!);
const BASE = import.meta.env.BASE_URL || "/";
if (!photo) throw new Error("Photo not found: " + slug);
---

<Layout title={`${photo.title} — Toshi Kuramochi Photography`}>
  <a href={BASE} class="back">← Back to Home</a>
  <h1 style="text-align:center;">{photo.title}</h1>
  <img src={photo.image} alt={photo.title} class="responsive" />
  <div class="small" style="text-align:center;">{photo.date}</div>
  {photo.caption && <p style="max-width:720px;margin:1rem auto;text-align:center;color:#444;">{photo.caption}</p>}
</Layout>
